(import 'class/obj/class.inc)
(import 'class/error/class.inc)
(import 'class/vector/class.inc)

(def-class 'lisp 'obj)
(dec-method 'vtable 'class/class_lisp)
(dec-method 'create 'class/lisp/create 'static '(r0 r1 r2) '(r0))
(dec-method 'new 'class/lisp/new 'static nil '(r0))
(dec-method 'init 'class/lisp/init 'static '(r0 r1 r2 r3 r4))
(dec-method 'deinit 'class/lisp/deinit 'final)

(dec-method 'env_push 'class/lisp/env_push 'static '(r0) '(r0))
(dec-method 'env_pop 'class/lisp/env_pop 'static '(r0) '(r0))
(dec-method 'env_bind 'class/lisp/env_bind 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'env_args_set 'class/lisp/env_args_set 'static '(r0 r3 r1))
(dec-method 'env_args_type 'class/lisp/env_args_type 'static '(r1 r3 r4) '(r1))

(dec-method 'read 'class/lisp/read 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_char 'class/lisp/read_char 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'read_rmacro 'class/lisp/read_rmacro 'static '(r0 r1 r2 r3) '(r0 r1 r2))
(dec-method 'read_list 'class/lisp/read_list 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_sym 'class/lisp/read_sym 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_str 'class/lisp/read_str 'static '(r0 r1 r2 r3) '(r0 r1 r2))
(dec-method 'read_num 'class/lisp/read_num 'static '(r0 r1 r2) '(r0 r1 r2))

(dec-method 'repl_eval 'class/lisp/repl_eval 'static '(r0 r1) '(r0 r1))
(dec-method 'repl_eval_list 'class/lisp/repl_eval_list 'static '(r0 r1) '(r0 r1))
(dec-method 'repl_apply 'class/lisp/repl_apply 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'repl_print 'class/lisp/repl_print 'static '(r0 r1 r2) '(r0))
(dec-method 'repl_expand 'class/lisp/repl_expand 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'repl_error 'class/lisp/repl_error 'static '(r0 r1 r2 r3) '(r0 r1))

(dec-method 'func_ffi 'class/lisp/func_ffi 'static '(r0 r1) '(r0 r1))
(dec-method 'func_macroexpand_1 'class/lisp/func_macroexpand_1 'static '(r0 r1) '(r0 r1))
(dec-method 'func_macroexpand 'class/lisp/func_macroexpand 'static '(r0 r1) '(r0 r1))
(dec-method 'func_defmacro 'class/lisp/func_defmacro 'static '(r0 r1) '(r0 r1))
(dec-method 'func_def 'class/lisp/func_def 'static '(r0 r1) '(r0 r1))
(dec-method 'func_defq 'class/lisp/func_defq 'static '(r0 r1) '(r0 r1))
(dec-method 'func_set 'class/lisp/func_set 'static '(r0 r1) '(r0 r1))
(dec-method 'func_setq 'class/lisp/func_setq 'static '(r0 r1) '(r0 r1))
(dec-method 'func_lambda 'class/lisp/func_lambda 'static '(r0 r1) '(r0 r1))
(dec-method 'func_quote 'class/lisp/func_quote 'static '(r0 r1) '(r0 r1))
(dec-method 'func_qquote 'class/lisp/func_qquote 'static '(r0 r1) '(r0 r1))
(dec-method 'func_add 'class/lisp/func_add 'static '(r0 r1) '(r0 r1))
(dec-method 'func_sub 'class/lisp/func_sub 'static '(r0 r1) '(r0 r1))
(dec-method 'func_mul 'class/lisp/func_mul 'static '(r0 r1) '(r0 r1))
(dec-method 'func_fmul 'class/lisp/func_fmul 'static '(r0 r1) '(r0 r1))
(dec-method 'func_div 'class/lisp/func_div 'static '(r0 r1) '(r0 r1))
(dec-method 'func_fdiv 'class/lisp/func_fdiv 'static '(r0 r1) '(r0 r1))
(dec-method 'func_mod 'class/lisp/func_mod 'static '(r0 r1) '(r0 r1))
(dec-method 'func_min 'class/lisp/func_min 'static '(r0 r1) '(r0 r1))
(dec-method 'func_max 'class/lisp/func_max 'static '(r0 r1) '(r0 r1))
(dec-method 'func_eql 'class/lisp/func_eql 'static '(r0 r1) '(r0 r1))
(dec-method 'func_eq 'class/lisp/func_eq 'static '(r0 r1) '(r0 r1))
(dec-method 'func_ne 'class/lisp/func_ne 'static '(r0 r1) '(r0 r1))
(dec-method 'func_lt 'class/lisp/func_lt 'static '(r0 r1) '(r0 r1))
(dec-method 'func_gt 'class/lisp/func_gt 'static '(r0 r1) '(r0 r1))
(dec-method 'func_le 'class/lisp/func_le 'static '(r0 r1) '(r0 r1))
(dec-method 'func_ge 'class/lisp/func_ge 'static '(r0 r1) '(r0 r1))
(dec-method 'func_cond 'class/lisp/func_cond 'static '(r0 r1) '(r0 r1))
(dec-method 'func_progn 'class/lisp/func_progn 'static '(r0 r1) '(r0 r1))
(dec-method 'func_length 'class/lisp/func_length 'static '(r0 r1) '(r0 r1))
(dec-method 'func_while 'class/lisp/func_while 'static '(r0 r1) '(r0 r1))
(dec-method 'func_print 'class/lisp/func_print 'static '(r0 r1) '(r0 r1))
(dec-method 'func_prin 'class/lisp/func_prin 'static '(r0 r1) '(r0 r1))
(dec-method 'func_env 'class/lisp/func_env 'static '(r0 r1) '(r0 r1))
(dec-method 'func_sym 'class/lisp/func_sym 'static '(r0 r1) '(r0 r1))
(dec-method 'func_str 'class/lisp/func_str 'static '(r0 r1) '(r0 r1))
(dec-method 'func_cat 'class/lisp/func_cat 'static '(r0 r1) '(r0 r1))
(dec-method 'func_elem 'class/lisp/func_elem 'static '(r0 r1) '(r0 r1))
(dec-method 'func_elemset 'class/lisp/func_elemset 'static '(r0 r1) '(r0 r1))
(dec-method 'func_copy 'class/lisp/func_copy 'static '(r0 r1) '(r0 r1))
(dec-method 'func_gensym 'class/lisp/func_gensym 'static '(r0 r1) '(r0 r1))
(dec-method 'func_filestream 'class/lisp/func_filestream 'static '(r0 r1) '(r0 r1))
(dec-method 'func_strstream 'class/lisp/func_strstream 'static '(r0 r1) '(r0 r1))
(dec-method 'func_readchar 'class/lisp/func_readchar 'static '(r0 r1) '(r0 r1))
(dec-method 'func_readline 'class/lisp/func_readline 'static '(r0 r1) '(r0 r1))
(dec-method 'func_writechar 'class/lisp/func_writechar 'static '(r0 r1) '(r0 r1))
(dec-method 'func_writeline 'class/lisp/func_writeline 'static '(r0 r1) '(r0 r1))
(dec-method 'func_write 'class/lisp/func_write 'static '(r0 r1) '(r0 r1))
(dec-method 'func_char 'class/lisp/func_char 'static '(r0 r1) '(r0 r1))
(dec-method 'func_code 'class/lisp/func_code 'static '(r0 r1) '(r0 r1))
(dec-method 'func_slice 'class/lisp/func_slice 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bshr 'class/lisp/func_bshr 'static '(r0 r1) '(r0 r1))
(dec-method 'func_basr 'class/lisp/func_basr 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bshl 'class/lisp/func_bshl 'static '(r0 r1) '(r0 r1))
(dec-method 'func_band 'class/lisp/func_band 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bor 'class/lisp/func_bor 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bxor 'class/lisp/func_bxor 'static '(r0 r1) '(r0 r1))
(dec-method 'func_push 'class/lisp/func_push 'static '(r0 r1) '(r0 r1))
(dec-method 'func_pop 'class/lisp/func_pop 'static '(r0 r1) '(r0 r1))
(dec-method 'func_apply 'class/lisp/func_apply 'static '(r0 r1) '(r0 r1))
(dec-method 'func_repl 'class/lisp/func_repl 'static '(r0 r1) '(r0 r1))
(dec-method 'func_eval 'class/lisp/func_eval 'static '(r0 r1) '(r0 r1))
(dec-method 'func_catch 'class/lisp/func_catch 'static '(r0 r1) '(r0 r1))
(dec-method 'func_save 'class/lisp/func_save 'static '(r0 r1) '(r0 r1))
(dec-method 'func_load 'class/lisp/func_load 'static '(r0 r1) '(r0 r1))
(dec-method 'func_inst_of 'class/lisp/func_inst_of 'static '(r0 r1) '(r0 r1))
(dec-method 'func_split 'class/lisp/func_split 'static '(r0 r1) '(r0 r1))
(dec-method 'func_defined 'class/lisp/func_defined 'static '(r0 r1) '(r0 r1))
(dec-method 'func_find 'class/lisp/func_find 'static '(r0 r1) '(r0 r1))
(dec-method 'func_age 'class/lisp/func_age 'static '(r0 r1) '(r0 r1))
(dec-method 'func_error 'class/lisp/func_error 'static '(r0 r1) '(r0 r1))
(dec-method 'func_pipe 'class/lisp/func_pipe 'static '(r0 r1) '(r0 r1))
(dec-method 'func_rpipe 'class/lisp/func_rpipe 'static '(r0 r1) '(r0 r1))
(dec-method 'func_wpipe 'class/lisp/func_wpipe 'static '(r0 r1) '(r0 r1))
(dec-method 'func_time 'class/lisp/func_time 'static '(r0 r1) '(r0 r1))
(dec-method 'func_clear 'class/lisp/func_clear 'static '(r0 r1) '(r0 r1))
(dec-method 'func_match 'class/lisp/func_match 'static '(r0 r1) '(r0 r1))
(dec-method 'func_each 'class/lisp/func_each 'static '(r0 r1) '(r0 r1))
(dec-method 'func_some 'class/lisp/func_some 'static '(r0 r1) '(r0 r1))
(dec-method 'func_list 'class/lisp/func_list 'static '(r0 r1) '(r0 r1))
(dec-method 'func_cmp 'class/lisp/func_cmp 'static '(r0 r1) '(r0 r1))
(dec-method 'func_array 'class/lisp/func_array 'static '(r0 r1) '(r0 r1))
(dec-method 'func_points 'class/lisp/func_points 'static '(r0 r1) '(r0 r1))
(dec-method 'func_fsqrt 'class/lisp/func_fsqrt 'static '(r0 r1) '(r0 r1))
(dec-method 'func_fmod 'class/lisp/func_fmod 'static '(r0 r1) '(r0 r1))
(dec-method 'func_frac 'class/lisp/func_frac 'static '(r0 r1) '(r0 r1))
(dec-method 'func_floor 'class/lisp/func_floor 'static '(r0 r1) '(r0 r1))
(dec-method 'func_fsin 'class/lisp/func_fsin 'static '(r0 r1) '(r0 r1))
(dec-method 'func_fcos 'class/lisp/func_fcos 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bind 'class/lisp/func_bind 'static '(r0 r1) '(r0 r1))
(dec-method 'func_read 'class/lisp/func_read 'static '(r0 r1) '(r0 r1))
(dec-method 'func_merge 'class/lisp/func_merge 'static '(r0 r1) '(r0 r1))
(dec-method 'func_part 'class/lisp/func_part 'static '(r0 r1) '(r0 r1))
(dec-method 'func_type 'class/lisp/func_type 'static '(r0 r1) '(r0 r1))

(def-enum 'func_type)
	(enum 'args_eval 'args_raw)
(def-enum-end)

(def-struct 'lisp 'obj)
	(ptr 'stdin)
	(ptr 'stdout)
	(ptr 'stderr)
	(ptr 'environment)
	(ulong 'nextsym)
	(ptr 'sym_optional)
	(ptr 'sym_rest)
	(ptr 'sym_nil)
	(ptr 'sym_t)
	(ptr 'sym_lambda)
	(ptr 'sym_macro)
	(ptr 'sym_quote)
	(ptr 'sym_qquote)
	(ptr 'sym_unquote)
	(ptr 'sym_splicing)
	(ptr 'sym_cat)
	(ptr 'sym_list)
	(ptr 'sym_underscore)
	(ptr 'sym_stream_name)
	(ptr 'sym_stream_line)
(def-struct-end)
